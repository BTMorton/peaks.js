<!DOCTYPE html>

<!--

  THIS FILE USED AS PLACEHOLDER HTML FOR DEVELOPMENT PURPOSES

-->

<html>
  <head>
    <title>Peaks.js Demo Page</title>

    <script src="http://localhost:1337/livereload.js"></script>

    <link rel='stylesheet' href='/build/css/peaks.css' />

    <!-- bower -->
    <script src="bower_components/jquery/jquery.js"></script>
    <script src="bower_components/lodash/dist/lodash.compat.js"></script>
    <script src="bower_components/KineticJS/index.js"></script>
    <script src="bower_components/eventEmitter/EventEmitter.js"></script>
    <script src="bower_components/handlebars/handlebars.js"></script>
    <script src="bower_components/handlebars/handlebars.runtime.js"></script>
    <script src="bower_components/waveform-data/dist/waveform-data.min.js"></script>
    <!-- endbower -->


    <script type="text/javascript">
        var require = {
          baseUrl: "lib/js/",
          paths: {
            "WaveformData": "/bower_components/waveform-data/dist/waveform-data.min",
            //"WaveformData": "/bower_components/waveform-data/dist/waveform-data",
            "EventEmitter": "/bower_components/eventEmitter/EventEmitter",
            "jquery": "/bower_components/jquery/jquery"
          }
        };
    </script>

    <script main="lib/js/main" src="lib/vendor/require.js"></script>

    <script>

      $(function () {

        require(['main'], function (peaks) {

          peaks = peaks;

          peaks.init({
            container: document.getElementById('waveform-visualiser-container'),
            audioElement: document.getElementById('audio'),
            dataUri: '/test_data/20131119_210000_bbcr4_all_in_the_mind.dat',
            segmentationData: '/test_information_data/20131119_210000_bbcr4_all_in_the_mind_segmentation.json',
            tagsData: '/test_information_data/20131119_210000_bbcr4_all_in_the_mind_tags.json',
            keywordsData: '/test_information_data/keywords.json',
            keyboard: true,
            height: 240,
            /*segments: [{
              startTime: 120,
              endTime: 140,
              editable: true,
              color: "#ff0000"
            },
            {
              startTime: 420,
              endTime: 540,
              editable: true,
              color: "#0000ff"
            }]*/
          });

          //Controls the on screen zoom-in and zoom-out buttons
          $("#button-controls").find("input").on("click", function (event) {
            event.preventDefault();
            //Display error on the page but deos not disabling the use of the page which is less intrusive and annoying for frequent users
            if ($(this).data("method") === "zoomIn" && $(this).attr("disable") === "true") {
              //Make error alert message visible
              $("#alert").text("Oh no! Lowest zoom level reached. Cannot zoom in any further.");
              if ($("#alert").hasClass("hidden")) {
                $("#alert").removeClass("hidden").addClass("visible");
              }
            } else if ($(this).data("method") === "zoomOut" && $(this).attr("disable") === "true") {
              //Make error alert message visible
              $("#alert").text("Oh no! Highest zoom level reached. Cannot zoom out any further.");
              if ($("#alert").hasClass("hidden")) {
                $("#alert").removeClass("hidden").addClass("visible");
              }
            } else {
              if ($("#alert").hasClass("visible")) {
                $("#alert").removeClass("visible").addClass("hidden");
              }
              peaks[$(this).data("namespace")][$(this).data("method")]();
            }
          });

          //Controls on screen segment controls e.g. setting in and out marker
          $("#marker-controls").find("input").on("click", function (event) {
            event.preventDefault();
            peaks[$(this).data("namespace")][$(this).data("method")]();
          });

          //Controls the on screen data overlays options buttons
          $("#options-controls").find("input").on("change", function (event) {
            event.preventDefault();
            var n = this.value;
            switch(Number(n)) {
              case 1:
                if ($("#Segments").prop("checked") === false) {
                  //$("#segmentText").text("Show Segments");
                  peaks.segments.segmentVisibility(false);
                } else {
                  //$("#segmentText").text("Hide Segments");
                  peaks.segments.segmentVisibility(true);
                }
                break;
              case 2:
                if ($("#Genders").prop("checked") === false) {
                  //$("#genderText").text("Show Speakers");
                  peaks.segments.genderVisibility(false);
                } else {
                  //$("#genderText").text("Hide Speakers");
                  peaks.segments.genderVisibility(true);
                }
                break;
              case 3:
                if ($("#Keywords").prop("checked") === false) {
                  //$("#keywordText").text("Show Keywords");
                  peaks.segments.keywordVisibility(false);
                } else {
                  //$("#keywordText").text("Hide Keywords");
                  peaks.segments.keywordVisibility(true);
                }
                break;
              default:
                console.log("No Case Defined");
            }
          });

          $("#dropdown").find("li").on("click", function (event) {
            event.preventDefault();
            var n = this.value;
            switch(Number(n)) {
              case 1:
                peaks.segments.genderVisibility(true);
                peaks.segments.keywordVisibility(false);
                peaks.segments.tagVisibility(false);
                $("#data-overlays-bar").trigger("click");
                $("#data-overlays-bar").text($(this).text());
                break;
              case 2:
                peaks.segments.genderVisibility(false);
                peaks.segments.keywordVisibility(true);
                peaks.segments.tagVisibility(false);
                $("#data-overlays-bar").trigger("click");
                $("#data-overlays-bar").text($(this).text());
                break;
              case 3:
                peaks.segments.genderVisibility(false);
                peaks.segments.keywordVisibility(false);
                peaks.segments.tagVisibility(true);
                $("#data-overlays-bar").trigger("click");
                $("#data-overlays-bar").text($(this).text());
                break;
              case 4:
                peaks.segments.genderVisibility(false);
                peaks.segments.keywordVisibility(false);
                peaks.segments.tagVisibility(false);
                $("#data-overlays-bar").trigger("click");
                $("#data-overlays-bar").text($(this).text());
                break;
              default:
                console.log("No Case Defined");
            }
          });

          $("#timing").find("select").on("change", function (event) {
            event.preventDefault();
            var n = this.value;
            peaks.option.changeTiming(n);
          });

          $("#speaker-name").find("select").on("change", function (event) {
            event.preventDefault();
            var n = this.value;
            peaks.option.changeSpeakerName(n);
          });

          $("#speakers").find("select").on("change", function (event) {
            event.preventDefault();
            var n = this.value;
            peaks.option.changeSpeakerDisplay(n);
          });

          $("#data_overlays").find("select").on("change", function (event) {
            event.preventDefault();
            var n = this.value;
            switch(Number(n)) {
              case 1:
                peaks.segments.genderVisibility(true);
                peaks.segments.keywordVisibility(false);
                peaks.segments.tagVisibility(false);
                break;
              case 2:
                peaks.segments.genderVisibility(false);
                peaks.segments.keywordVisibility(true);
                peaks.segments.tagVisibility(false);
                break;
              case 3:
                peaks.segments.genderVisibility(false);
                peaks.segments.keywordVisibility(false);
                peaks.segments.tagVisibility(true);
                break;
              case 4:
                peaks.segments.genderVisibility(false);
                peaks.segments.keywordVisibility(false);
                peaks.segments.tagVisibility(false);
                break;
              default:
                console.log("No Case Defined");
            }
          });

          $("#options_bar").click(function(){
            $("#options").slideToggle("slow");
          });

          $("#data-overlays-bar").click(function(){
            $("#data-overlays-list").slideToggle("slow");
          });

          $("#speakerSearch").on("search", function() {
            var searchValue = this.value;
            peaks.search.searchSpeakers(searchValue);
          });
        });
      });

    </script>

  </head>
  <body>
    <!--<div id="outer_wrapper">-->
      <div id="implementation_options">
        <!--<div id="options_bar">Click to Show/Hide Options</div>-->
        <div id="options">
          <ul>
            <li id="timing" >
              <!--<label>Axis Labelling</label>-->
              <select class="dropdown">
                <option value="1">Option 1</option> <!--1:14:40 Format-->
                <option value="2" selected>Option 2</option> <!--1h 14m 40s Format-->
              </select>
            </li>

            <li id="speakers">
              <!--<label>Speaker Data Overlay</label>-->
              <select class="dropdown">
                <option value="1">Option 1</option><!--Speaker Coloured by Name [Always Visible]-->
                <option value="3">Option 2</option><!--Speaker Coloured by Gender [Visible on Hover]-->
              </select>
            </li>

            <li id="speaker-name">
              <!--<label>Speaker Name Visibility</label>-->
              <select class="dropdown">
                <option value="1">Option 1</option><!--Speaker Name Bottom Corner-->
                <option value="2" selected>Option 2</option><!--Speaker Name Tooltip-->
              </select>
            </li>

            <li id="data_overlays" >
              <!--<label>Data Overlays Visibility</label>-->
              <select class="dropdown">
                <option value="4" id="waveform_option" class="active">N</option><!--None-->
                <option value="1" id="speakers_option" class="active">S</option><!--Speakers-->
                <option value="2" id="keywords_option" class="active">K</option><!--Keywords-->
                <option value="3" id="topics_option" class="active">T</option><!--Topics-->
              </select>
            </li>
          </ul>
        </div>
      </div>

      <div id="inner_wrapper">

        <div id="demo-controls">
          <audio id="audio" class="controls" controls=controls>
            <source src="/test_data/20131119_210000_bbcr4_all_in_the_mind.mp3" type="audio/mpeg">
            <source src="/test_data/20131119_210000_bbcr4_all_in_the_mind.ogg" type="audio/ogg">
            Your browser does not support the audio element.
          </audio>

          <div id="button-controls" class="controls">
            <input id="zoomIn" type="image" src="/build/images/zoom_in_button.png" alt="Zoom In" width="30" height="29" vspace="0" data-namespace="zoom" data-method="zoomIn" title="Zoom In">
            <input id="zoomOut" type="image" src="/build/images/zoom_out_button.png" alt="Zoom Out" width="30" height="29" vspace="0" data-namespace="zoom" data-method="zoomOut" title="Zoom Out">
            <input id="overview" type="image" src="/build/images/overview_button.png" alt="Fit Overview" width="30" height="29" vspace="0" data-namespace="zoom" data-method="overview" title="Fit Overview">
          </div>

          <div id="marker-controls" class="controls">
            <input id="cut" type="image" src="/build/images/scissors.png" alt="Segment" width="30" height="29" vspace="0" data-namespace="segments" data-method="cut_mode" title="Make Segment Selection">
            <input id="inMarker" type="image" src="/build/images/in_marker_button.png" alt="In Marker" width="30" height="29" vspace="0" data-namespace="segments" data-method="setInMarker" title="Set In Marker" disabled>
            <input id="outMarker" type="image" src="/build/images/out_marker_button.png" alt="Out Marker" width="30" height="29" vspace="0" data-namespace="segments" data-method="setOutMarker" title="Set Out Marker" disabled>
            <input id="playSegment" type="image" src="/build/images/play_selection_button.png" alt="Play Last Segment" width="30" height="29" vspace="0" data-namespace="segments" data-method="selection" title="Play Last Segment" disabled>
          </div>

          <!--<div id="options-controls" class="controls" style="padding:10px; margin-right:0px">
            <input id="Segments" type="checkbox" value="1" checked>
              <label id="segmentText" for="Segments">Segments</label>
            <input id="Genders" type="checkbox" value="2" checked>
              <label id="genderText" for="Genders">Speakers</label>
            <input id="Keywords" type="checkbox" value="3" checked>
              <label id="keywordText" for="Keywords">Keywords</label>
          </div>-->
          <div id="options-controls" class="controls" style="padding:8px; margin-right:0px">
            <input id="Segments" type="checkbox" value="1" checked>
              <label id="segmentText" for="Segments">Segments</label>
          </div>

          <!--<div id="data-overlays" class="controls" style="margin-right:0px">
            <div id="data-overlays-bar">None</div>
            <div id="data-overlays-list">
              <ul id="dropdown">
                <li value="4" id="waveform_text" class="active">None</li>
                <li value="1" id="speaker_text" class="active">Speakers</li>
                <li value="2" id="keywords_text" class="active">Keywords</li>
                <li value="3" id="topics_text" class="active">Topics</li>
              </ul>
            </div>
          </div>-->

          <div id="speaker-search" class="controls" style="margin-right:0px; margin-top:4px; float:right;">
            <datalist id="speakers_list"> 
            </datalist>
            <input type="search" id="speakerSearch" results="5" placeholder="Search Speakers" list="speakers_list" autocomplete="on" style="font-size:16px;">
          </div>
        </div>

        <div id="waveform-visualiser-container">

        </div>

        <div id="speaker-information">
          <div id="speaker"></div>
        </div>

        <div id="segment-information">
          <label class="timeLabel" id="start">Start: </label><label class="time" id="startTime">0:00</label>
          <label class="timeLabel" id="end">End: </label><label class="time" id="endTime">0:00</label>
          <label class="timeLabel" id="duration">Duration: </label><label class="time" id="durationTime">0:00</label>
        </div>

        <div id="alert" class="hidden">
        </div>

      </div>
    <!--</div>-->
  </body>
</html>
